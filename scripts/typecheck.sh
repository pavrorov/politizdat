#!/bin/sh -efu

INPUT="$1"; shift
ret=0

# Проверка подозрительных последовательностей, не обязательно
# являющихся ошибочными, но требудщих ручного контроля.
# 
# 1) Проверка на отсутствие знака препинания перед сноской.
# 2) Проверка знаков !? после группы.
# 3) Проверка экранированных пробелов (\ ).
grep -Hn --color \
	 -e '\(~\+-*\|[.,;:]\+\)[[:space:]]*\\\(cite\|[[:lower:]]*note\)' \
	 -e '}[[:space:]]*[?!]' \
	 -e '\\[[:space:]]' \
	 "$INPUT" || ret=$?

[ $ret -ne 0 ]
